//@version=5
indicator("economic screener")

expr = close
var string country = str.match(syminfo.tickerid, "country=[A-Z][A-Z]")
country_code = str.substring(country, 8, 10)
econ_prefix = "ECONOMICS:" + country_code

get_econ(econ_code) => econ = request.security(econ_prefix + econ_code, timeframe.period, expr, lookahead=barmerge.lookahead_on, ignore_invalid_symbol=true)

tvc_10y = request.security("TVC:" + country_code + "10Y", timeframe.period, expr, lookahead=barmerge.lookahead_on, ignore_invalid_symbol=true)
plot(tvc_10y, title="TVC.10Y")
plot(get_econ("GDP"), title="ECONOMICS.GDP")
plot(get_econ("GDPYY"), title="ECONOMICS.GDPYY")
plot(get_econ("MGDPYY"), title="ECONOMICS.MGDPYY")
plot(get_econ("GDPQQ"), title="ECONOMICS.GDPQQ")
plot(get_econ("GDPPC"), title="ECONOMICS.GDPPC")
plot(get_econ("GDPPCP"), title="ECONOMICS.GDPPCP")
plot(get_econ("EMP"), title="ECONOMICS.EMP")
plot(get_econ("EMR"), title="ECONOMICS.EMR")
plot(get_econ("FTE"), title="ECONOMICS.FTE")
plot(get_econ("LFPR"), title="ECONOMICS.LFPR")
plot(get_econ("LC"), title="ECONOMICS.LC")
plot(get_econ("LTUR"), title="ECONOMICS.LTUR")
plot(get_econ("PTE"), title="ECONOMICS.PTE")
plot(get_econ("POP"), title="ECONOMICS.POP")
plot(get_econ("RAM"), title="ECONOMICS.RAM")
plot(get_econ("UP"), title="ECONOMICS.UP")
plot(get_econ("UR"), title="ECONOMICS.UR")
plot(get_econ("WG"), title="ECONOMICS.WG")
plot(get_econ("YUR"), title="ECONOMICS.YUR")
plot(get_econ("CCP"), title="ECONOMICS.CCP")
plot(get_econ("EP"), title="ECONOMICS.EP")
plot(get_econ("FI"), title="ECONOMICS.FI")
plot(get_econ("IPRI"), title="ECONOMICS.IPRI")
plot(get_econ("IE"), title="ECONOMICS.IE")
plot(get_econ("IRMM"), title="ECONOMICS.IRMM")
plot(get_econ("IRYY"), title="ECONOMICS.IRYY")
plot(get_econ("HIRMM"), title="ECONOMICS.HIRMM")
plot(get_econ("HIRYY"), title="ECONOMICS.HIRYY")
plot(get_econ("PPIYY"), title="ECONOMICS.PPIYY")
plot(get_econ("PPI"), title="ECONOMICS.PPI")
plot(get_econ("PPIMM"), title="ECONOMICS.PPIMM")
plot(get_econ("HB"), title="ECONOMICS.HB")
plot(get_econ("HOSP"), title="ECONOMICS.HOSP")
plot(get_econ("ICUB"), title="ECONOMICS.ICUB")
plot(get_econ("MD"), title="ECONOMICS.MD")
plot(get_econ("NURS"), title="ECONOMICS.NURS")
plot(get_econ("LR"), title="ECONOMICS.LR")
plot(get_econ("CRR"), title="ECONOMICS.CRR")
plot(get_econ("DIR"), title="ECONOMICS.DIR")
plot(get_econ("INBR"), title="ECONOMICS.INBR")
plot(get_econ("INTR"), title="ECONOMICS.INTR")
plot(get_econ("LG"), title="ECONOMICS.LG")
plot(get_econ("PDG"), title="ECONOMICS.PDG")
plot(get_econ("CAG"), title="ECONOMICS.CAG")
plot(get_econ("TOT"), title="ECONOMICS.TOT")
plot(get_econ("TI"), title="ECONOMICS.TI")
plot(get_econ("TA"), title="ECONOMICS.TA")
plot(get_econ("WES"), title="ECONOMICS.WES")
plot(get_econ("NGIR"), title="ECONOMICS.NGIR")
plot(get_econ("NGI"), title="ECONOMICS.NGI")
plot(get_econ("COP"), title="ECONOMICS.COP")
plot(get_econ("COIR"), title="ECONOMICS.COIR")
plot(get_econ("AA"), title="ECONOMICS.AA")
plot(get_econ("GBP"), title="ECONOMICS.GBP")
plot(get_econ("GDG"), title="ECONOMICS.GDG")
plot(get_econ("GSG"), title="ECONOMICS.GSG")
plot(get_econ("ME"), title="ECONOMICS.ME")
plot(get_econ("CAP"), title="ECONOMICS.CAP")
plot(get_econ("CAR"), title="ECONOMICS.CAR")
plot(get_econ("CEP"), title="ECONOMICS.CEP")
plot(get_econ("GCI"), title="ECONOMICS.GCI")
plot(get_econ("GCR"), title="ECONOMICS.GCR")
plot(get_econ("CORPI"), title="ECONOMICS.CORPI")
plot(get_econ("CORR"), title="ECONOMICS.CORR")
plot(get_econ("COR"), title="ECONOMICS.COR")
plot(get_econ("EDBR"), title="ECONOMICS.EDBR")
plot(get_econ("ELP"), title="ECONOMICS.ELP")
plot(get_econ("IPYY"), title="ECONOMICS.IPYY")
plot(get_econ("IPMM"), title="ECONOMICS.IPMM")
plot(get_econ("ISP"), title="ECONOMICS.ISP")
plot(get_econ("MPRYY"), title="ECONOMICS.MPRYY")
plot(get_econ("MIP"), title="ECONOMICS.MIP")
plot(get_econ("SP"), title="ECONOMICS.SP")
plot(get_econ("TVS"), title="ECONOMICS.TVS")
plot(get_econ("CPI"), title="ECONOMICS.CPI")
plot(get_econ("BLR"), title="ECONOMICS.BLR")
plot(get_econ("CCI"), title="ECONOMICS.CCI")
plot(get_econ("HICP"), title="ECONOMICS.HICP")
plot(get_econ("GASP"), title="ECONOMICS.GASP")
plot(get_econ("HDG"), title="ECONOMICS.HDG")
plot(get_econ("RSYY"), title="ECONOMICS.RSYY")
plot(get_econ("RSMM"), title="ECONOMICS.RSMM")
plot(get_econ("COUT"), title="ECONOMICS.COUT")
plot(get_econ("HOR"), title="ECONOMICS.HOR")
plot(get_econ("CPIHU"), title="ECONOMICS.CPIHU")
plot(get_econ("CTR"), title="ECONOMICS.CTR")
plot(get_econ("PITR"), title="ECONOMICS.PITR")
plot(get_econ("STR"), title="ECONOMICS.STR")
plot(get_econ("SSR"), title="ECONOMICS.SSR")
plot(get_econ("SSRC"), title="ECONOMICS.SSRC")
plot(get_econ("SSRE"), title="ECONOMICS.SSRE")
plot(get_econ("HDI"), title="ECONOMICS.HDI")
plot(get_econ("IPA"), title="ECONOMICS.IPA")
plot(get_econ("RAW"), title="ECONOMICS.RAW")
